{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Actualizar Mascota</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body class="bodygeneral">
    <div class="mascotas-container">
        <h2 style="text-align:center; color:#ff6600;">✏️ Actualizar Mascota</h2>

        <form id="formActualizar" style="max-width:400px; margin:auto;">
            <label>Nombre:</label>
            <input type="text" name="nombre" value="{{ mascota.nombre }}" required><br><br>

            <label>Edad:</label>
            <input type="number" name="edad" value="{{ mascota.edad }}" required><br><br>

            <label>Raza:</label>
            <input type="text" name="raza" value="{{ mascota.raza }}" required><br><br>

            <label>Tipo:</label>
            <input type="text" name="tipo" value="{{ mascota.tipo }}" required><br><br>

            <button type="submit" style="background:#00b7ff; color:white; font-weight:bold;">Guardar Cambios</button>
        </form>

        <div style="text-align:center; margin-top:20px;">
            <a href="{% url 'listar_mascotas' %}?rol={{ rol }}" class="listar_mascotas">Volver</a>
        </div>
    </div>

    <script>
    const csrftoken = '{{ csrf_token }}';
    const form = document.getElementById('formActualizar');

    form.addEventListener('submit', function(e){
        e.preventDefault();

        const data = {
            nombre: form.nombre.value,
            edad: form.edad.value,
            raza: form.raza.value,
            tipo: form.tipo.value
        };

        fetch(window.location.pathname, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrftoken
            },
            body: JSON.stringify(data)
        })
        .then(res => res.json())
        .then(res => {
            if(res.mensaje){
                alert(res.mensaje);
                window.location.href = "{% url 'listar_mascotas' %}?rol={{ rol }}";
            } else if(res.error){
                alert('Error: ' + res.error);
            }
        })
        .catch(err => alert('Error: ' + err));
    });
    </script>
</body>
</html>
