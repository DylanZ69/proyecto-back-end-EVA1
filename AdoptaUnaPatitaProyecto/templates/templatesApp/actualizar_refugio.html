{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Actualizar Refugio</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
</head>
<body class="bodygeneral">
    <div class="mascotas-container">
        <h2 style="text-align:center; color:#ff6600;">Actualizar Refugio</h2>

        <form id="formActualizarRefugio" style="max-width:400px; margin:auto;">
            <label>Nombre:</label>
            <input type="text" name="nombre" value="{{ refugio.nombre }}" required><br><br>

            <label>Dirección:</label>
            <input type="text" name="direccion" value="{{ refugio.direccion }}" required><br><br>

            <label>Teléfono:</label>
            <input type="text" name="telefono" value="{{ refugio.telefono }}" required><br><br>

            <button type="submit" style="background:#00b7ff; color:white; font-weight:bold;">Guardar Cambios</button>
        </form>

        <div style="text-align:center; margin-top:20px;">
            <a href="{% url 'listar_refugios' %}?rol={{ rol }}" class="volvermascotas">Volver</a>
        </div>
    </div>

    <script>
    const csrftoken = '{{ csrf_token }}';
    const form = document.getElementById('formActualizarRefugio');

    form.addEventListener('submit', function(e){
        e.preventDefault();

        const data = {
            nombre: form.nombre.value,
            direccion: form.direccion.value,
            telefono: form.telefono.value
        };

        fetch(window.location.pathname, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': csrftoken
            },
            body: JSON.stringify(data)
        })
        .then(res => res.json())
        .then(res => {
            if(res.mensaje){
                alert(res.mensaje);
                window.location.href = "{% url 'listar_refugios' %}?rol={{ rol }}";
            } else if(res.error){
                alert('Error: ' + res.error);
            }
        })
        .catch(err => alert('Error: ' + err));
    });
    </script>
</body>
</html>
